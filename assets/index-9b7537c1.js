(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function o(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?s.credentials="include":e.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(e){if(e.ep)return;e.ep=!0;const s=o(e);fetch(e.href,s)}})();const c={board:document.querySelector(".board"),boardContainer:document.querySelector(".board-container"),win:document.querySelector(".win"),card:document.querySelector(".card"),canvas:document.getElementById("canvas"),dimensions:document.querySelector(".board").dataset.dimension},a={flippedCards:0,totalFlips:0,loop:null,imageParts:[],id:0},A=t=>{if(!t||!Array.isArray(t))throw new Error("Передайте значения в виде массива!");const o=[...t.sort(()=>Math.random(t)-.5)].slice(0,8),r=[...o,...o];return r.sort(()=>Math.random(r)-.5)},L=()=>{a.flippedCards++,a.totalFlips++},g=()=>a.flippedCards=0,S=()=>a.flippedCards<2,h=()=>a.flippedCards===2,E=t=>t.classList.add("flipped"),T=()=>{const t=document.querySelectorAll(".flipped:not(.matched)");t[0].innerText===t[1].innerText?w(t):setTimeout(()=>{M()},1e3)},w=t=>{t.forEach(n=>n.classList.add("matched")),h()&&g(),F(t)},M=()=>{document.querySelectorAll(".card:not(.matched)").forEach(n=>n.classList.remove("flipped")),g()},I=()=>!document.querySelectorAll(".card:not(.flipped)").length,P=()=>{c.boardContainer.classList.add("flipped"),c.win.innerHTML=`
      <span class="win-text">
        Игра успешно пройдена!<br />
        количество шагов: <span class="highlight">${a.totalFlips}</span><br />
      </span>
    `,clearInterval(a.loop)},F=t=>{t.forEach(n=>{let o=n.getAttribute("id");setTimeout(()=>{const r=`
      <img src = ${a.imageParts[o]} class='partImage'></img>`;n.insertAdjacentHTML("beforeend",r)},1e3)})},O=()=>{const t=getComputedStyle(c.board),n=document.querySelectorAll(".partImage");let o=parseFloat(t.gridGap);const r=setInterval(()=>{o-=.5,o<=0&&(o=0,clearInterval(r)),c.board.style.gridGap=`${o}px`,n.forEach(e=>e.style.borderRadius="0px")},50);setTimeout(()=>P(),4e3)},q=()=>{if(c.dimensions%2!==0)throw new Error("Размер игрового поля должен быть четным!");const r=A(["1","2","3","4","5","6","7","8","9","10"]).map(e=>`
        <div class='card' id=${a.id++}>
            <div class='card-back'></div>
            <div class='card-front'>${e}</div>
        </div>`).join("");c.board.insertAdjacentHTML("beforeend",r)},x=t=>{S()&&E(t),L(),h()&&T(),I()&&setTimeout(()=>{O()},1e3)},D=t=>{const o=t.target.parentElement;o.classList.contains("card")&&!o.classList.contains("flipped")&&x(o)},H=t=>{const n=c.canvas,o=c.dimensions,r=n.getContext("2d"),e=new Image;e.crossOrigin="anonymous",e.src=t,e.onload=()=>{const s=e.width,i=e.height;n.width=s,n.height=i,r.drawImage(e,0,0,s,i);const l=s/o,p=i/o;let f=[];for(let u=0;u<o;u++)for(let m=0;m<o;m++){const y=m*l,b=u*p,C=r.getImageData(y,b,l,p),d=document.createElement("canvas"),v=d.getContext("2d");d.width=l,d.height=p,v.putImageData(C,0,0),f.push(d.toDataURL())}a.imageParts=[...f]}},j="/MemoryGame/assets/background_сard-50e996b3.jpg";document.addEventListener("DOMContentLoaded",()=>{H(j),q(),document.addEventListener("click",D)});
